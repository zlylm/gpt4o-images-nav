import{q as C,t as A,$ as W,f as p,o as c,I as v,m as q,c as I,a0 as J,a1 as U,B as Z,a2 as tt,F,x as N,n as x,v as t,y as s,w as d,g as Y,j as et,E as B,k as j,a3 as st,W as ot,A as L,a4 as at,a5 as nt,h as G,H as T,a6 as lt,a7 as ct,z as Q,a8 as it,a9 as rt,aa as dt,ab as ut,ac as vt,ad as pt}from"./index-DOWe7wZj.js";import{u as D}from"./project-DI86R4mO.js";import{E as K}from"./el-button-C6FnvbZr.js";import{E as _t}from"./el-input-C5EvkPg-.js";import"./aria-CDFoEfgR.js";const mt={__name:"CountUp",props:{endVal:{type:Number,required:!0},startVal:{type:Number,default:0},duration:{type:Number,default:2},options:{type:Object,default:()=>({})}},setup($){const r=$,_=C(r.startVal),y=o=>r.options.separator?o.toLocaleString():o.toString(),m=()=>{const o=Date.now(),n=r.startVal,l=r.endVal,M=r.duration*1e3,P=()=>{const z=Date.now(),w=Math.min((z-o)/M,1),i=1-Math.pow(1-w,4),f=Math.floor(n+(l-n)*i);_.value=y(f),w<1?requestAnimationFrame(P):_.value=y(l)};requestAnimationFrame(P)};return A(()=>{m()}),W(()=>r.endVal,()=>{m()}),(o,n)=>(c(),p("span",null,v(_.value),1))}},ft={class:"statistics-cards"},ht={class:"stat-icon"},gt={class:"stat-content"},bt={class:"stat-value"},jt={class:"stat-label"},kt={class:"stat-chart"},yt={__name:"StatisticsCards",setup($){const r=D(),_=I(()=>[{key:"projects",label:"项目数量",value:r.statistics.projectCount,icon:J,color:"#3b82f6",gradient:"linear-gradient(135deg, #3b82f6, #1d4ed8)",trend:12.5},{key:"devices",label:"设备数量",value:r.statistics.deviceCount,icon:U,color:"#06b6d4",gradient:"linear-gradient(135deg, #06b6d4, #0891b2)",trend:8.3},{key:"loads",label:"负载数量",value:r.statistics.loadCount,icon:Z,color:"#10b981",gradient:"linear-gradient(135deg, #10b981, #059669)",trend:15.7},{key:"alarms",label:"告警数量",value:r.statistics.alarmCount,icon:tt,color:"#f59e0b",gradient:"linear-gradient(135deg, #f59e0b, #d97706)",trend:-5.2}]);return(y,m)=>{const o=B;return c(),p("div",ft,[(c(!0),p(F,null,N(_.value,(n,l)=>(c(),p("div",{key:n.key,class:x(["stat-card glass-card",`stat-card-${l+1}`])},[t("div",ht,[s(o,{size:32,color:n.color},{default:d(()=>[(c(),Y(et(n.icon)))]),_:2},1032,["color"])]),t("div",gt,[t("div",bt,[s(mt,{"end-val":n.value,duration:2,options:{separator:","}},null,8,["end-val"])]),t("div",jt,v(n.label),1),t("div",{class:x(["stat-trend",n.trend>0?"trend-up":"trend-down"])},[s(o,{size:"12"},{default:d(()=>[n.trend>0?(c(),Y(j(st),{key:0})):(c(),Y(j(ot),{key:1}))]),_:2},1024),t("span",null,v(Math.abs(n.trend))+"%",1)],2)]),t("div",kt,[t("div",{class:"mini-chart",style:L({background:n.gradient})},null,4)])],2))),128))])}}},$t=q(yt,[["__scopeId","data-v-c08291f7"]]),Ct={class:"project-list-container glass-card"},wt={class:"list-header"},xt={class:"list-actions"},Pt={class:"project-list scrollbar-thin"},Vt=["onClick"],Mt={class:"project-info"},zt={class:"project-name"},St={class:"project-meta"},Et={class:"device-count"},Lt={class:"project-actions"},It={key:0,class:"empty-state"},Ft={class:"list-footer"},Nt={class:"project-summary"},qt={__name:"ProjectList",emits:["project-select"],setup($,{emit:r}){const _=r,y=Q(),m=D(),o=C(""),n=C(null),l=I(()=>o.value?m.projects.filter(i=>i.name.toLowerCase().includes(o.value.toLowerCase())):m.projects),M=I(()=>m.projects.reduce((i,f)=>i+Math.floor(f.deviceCount*f.onlineRate/100),0)),P=i=>{n.value=i,_("project-select",i)},z=i=>{y.push(`/project/${i.id}`)},w=i=>i>=95?"rate-excellent":i>=85?"rate-good":i>=70?"rate-warning":"rate-danger";return(i,f)=>{const V=B,X=_t,E=K;return c(),p("div",Ct,[t("div",wt,[f[1]||(f[1]=t("h3",{class:"list-title"},"项目列表",-1)),t("div",xt,[s(X,{modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=g=>o.value=g),placeholder:"搜索项目",size:"small",class:"search-input",clearable:""},{prefix:d(()=>[s(V,null,{default:d(()=>[s(j(at))]),_:1})]),_:1},8,["modelValue"]),s(E,{size:"small",circle:"",class:"filter-btn"},{default:d(()=>[s(V,null,{default:d(()=>[s(j(nt))]),_:1})]),_:1})])]),t("div",Pt,[(c(!0),p(F,null,N(l.value,g=>{var a;return c(),p("div",{key:g.id,class:x(["project-item",{active:((a=n.value)==null?void 0:a.id)===g.id}]),onClick:e=>P(g)},[t("div",{class:x(["status-indicator",`status-${g.status}`])},null,2),t("div",Mt,[t("div",zt,v(g.name),1),t("div",St,[t("span",Et,[s(V,{size:"12"},{default:d(()=>[s(j(U))]),_:1}),T(" "+v(g.deviceCount)+" 台设备 ",1)]),t("span",{class:x(["online-rate",w(g.onlineRate)])}," 在线率 "+v(g.onlineRate)+"% ",3)])]),t("div",Lt,[s(E,{size:"small",type:"primary",link:"",onClick:lt(e=>z(g),["stop"])},{default:d(()=>f[2]||(f[2]=[T(" 查看详情 ",-1)])),_:2,__:[2]},1032,["onClick"])])],10,Vt)}),128)),l.value.length===0?(c(),p("div",It,[s(V,{size:"48",color:"#6b7280"},{default:d(()=>[s(j(ct))]),_:1}),f[3]||(f[3]=t("p",null,"暂无项目数据",-1))])):G("",!0)]),t("div",Ft,[t("div",Nt,[t("span",null,"共 "+v(j(m).projects.length)+" 个项目",1),t("span",null,"在线设备 "+v(M.value)+" 台",1)])])])}}},Xt=q(qt,[["__scopeId","data-v-0d343543"]]),Yt={class:"project-map-container"},At={class:"mock-map"},Bt=["onClick"],Dt={class:"marker-label"},Rt={class:"marker-name"},Ot={class:"marker-info"},Ht={class:"connection-lines",width:"100%",height:"100%"},Tt=["d"],Ut={class:"map-controls"},Gt={class:"control-group"},Qt={class:"control-group"},Kt={class:"tooltip-header"},Wt={class:"tooltip-content"},Jt={class:"tooltip-item"},Zt={class:"tooltip-item"},te={class:"tooltip-item"},ee={__name:"ProjectMap",props:{projects:{type:Array,default:()=>[]},selectedProject:{type:Object,default:null}},emits:["project-click"],setup($,{emit:r}){const _=$,y=r,m=C(null),o=C(null),n=C({left:"0px",top:"0px"}),l=C(1),M=a=>{const b=(a.location.lng-116.4074)*1e3*l.value,u=(a.location.lat-39.9042)*-1e3*l.value;return{left:`${50+b}%`,top:`${50+u}%`,transform:"translate(-50%, -50%)"}},P=I(()=>{if(_.projects.length<2)return[];const a=[],e=50,h=50;return _.projects.forEach((b,u)=>{if(u===0)return;const k=_.projects[u-1],S=e+(k.location.lng-116.4074)*1e3*l.value,R=h+(k.location.lat-39.9042)*-1e3*l.value,O=e+(b.location.lng-116.4074)*1e3*l.value,H=h+(b.location.lat-39.9042)*-1e3*l.value;a.push({path:`M ${S}% ${R}% Q ${(S+O)/2}% ${(R+H)/2-5}% ${O}% ${H}%`})}),a}),z=a=>{y("project-click",a)},w=(a,e)=>{o.value=a,n.value={left:`${e.clientX+10}px`,top:`${e.clientY-10}px`}},i=()=>{o.value=null},f=()=>{l.value=Math.min(l.value*1.2,3)},V=()=>{l.value=Math.max(l.value/1.2,.5)},X=()=>{l.value=1},E=()=>{var a;document.fullscreenElement?document.exitFullscreen():(a=m.value)==null||a.requestFullscreen()},g=a=>({online:"正常",warning:"告警",offline:"离线"})[a]||"未知";return A(()=>{var e;const a=(e=m.value)==null?void 0:e.querySelectorAll(".project-marker");a==null||a.forEach(h=>{h.addEventListener("mouseenter",b=>{const u=parseInt(b.currentTarget.dataset.projectId),k=_.projects.find(S=>S.id===u);k&&w(k,b)}),h.addEventListener("mouseleave",i)})}),it(()=>{var e;const a=(e=m.value)==null?void 0:e.querySelectorAll(".project-marker");a==null||a.forEach(h=>{h.removeEventListener("mouseenter",w),h.removeEventListener("mouseleave",i)})}),(a,e)=>{const h=B,b=K;return c(),p("div",Yt,[t("div",{ref_key:"mapContainer",ref:m,class:"map-container"},[t("div",At,[e[2]||(e[2]=t("div",{class:"map-grid"},null,-1)),(c(!0),p(F,null,N($.projects,u=>{var k;return c(),p("div",{key:u.id,class:x(["project-marker",[`marker-${u.status}`,{"marker-selected":((k=$.selectedProject)==null?void 0:k.id)===u.id}]]),style:L(M(u)),onClick:S=>z(u)},[e[0]||(e[0]=t("div",{class:"marker-dot"},[t("div",{class:"marker-pulse"})],-1)),t("div",Dt,[t("div",Rt,v(u.name),1),t("div",Ot,v(u.deviceCount)+"台设备",1)])],14,Bt)}),128)),(c(),p("svg",Ht,[e[1]||(e[1]=t("defs",null,[t("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[t("stop",{offset:"0%",style:{"stop-color":"#3b82f6","stop-opacity":"0"}}),t("stop",{offset:"50%",style:{"stop-color":"#06b6d4","stop-opacity":"0.6"}}),t("stop",{offset:"100%",style:{"stop-color":"#3b82f6","stop-opacity":"0"}})])],-1)),(c(!0),p(F,null,N(P.value,(u,k)=>(c(),p("path",{key:k,d:u.path,stroke:"url(#lineGradient)","stroke-width":"2",fill:"none",class:"connection-line",style:L({animationDelay:`${k*.5}s`})},null,12,Tt))),128))]))])],512),t("div",Ut,[t("div",Gt,[s(b,{circle:"",size:"small",class:"control-btn",onClick:f},{default:d(()=>[s(h,null,{default:d(()=>[s(j(dt))]),_:1})]),_:1}),s(b,{circle:"",size:"small",class:"control-btn",onClick:V},{default:d(()=>[s(h,null,{default:d(()=>[s(j(ut))]),_:1})]),_:1})]),t("div",Qt,[s(b,{circle:"",size:"small",class:"control-btn",onClick:X},{default:d(()=>[s(h,null,{default:d(()=>[s(j(vt))]),_:1})]),_:1}),s(b,{circle:"",size:"small",class:"control-btn",onClick:E},{default:d(()=>[s(h,null,{default:d(()=>[s(j(pt))]),_:1})]),_:1})])]),e[6]||(e[6]=rt('<div class="map-legend" data-v-cb7c141f><div class="legend-title" data-v-cb7c141f>设备状态</div><div class="legend-items" data-v-cb7c141f><div class="legend-item" data-v-cb7c141f><div class="legend-dot status-online" data-v-cb7c141f></div><span data-v-cb7c141f>正常运行</span></div><div class="legend-item" data-v-cb7c141f><div class="legend-dot status-warning" data-v-cb7c141f></div><span data-v-cb7c141f>告警状态</span></div><div class="legend-item" data-v-cb7c141f><div class="legend-dot status-offline" data-v-cb7c141f></div><span data-v-cb7c141f>离线状态</span></div></div></div>',1)),o.value?(c(),p("div",{key:0,class:"project-tooltip",style:L(n.value)},[t("div",Kt,[t("h4",null,v(o.value.name),1),t("div",{class:x(["status-badge",`status-${o.value.status}`])},v(g(o.value.status)),3)]),t("div",Wt,[t("div",Jt,[e[3]||(e[3]=t("span",null,"设备数量:",-1)),t("strong",null,v(o.value.deviceCount)+"台",1)]),t("div",Zt,[e[4]||(e[4]=t("span",null,"在线率:",-1)),t("strong",null,v(o.value.onlineRate)+"%",1)]),t("div",te,[e[5]||(e[5]=t("span",null,"位置:",-1)),t("strong",null,v(o.value.location.lat.toFixed(4))+", "+v(o.value.location.lng.toFixed(4)),1)])])],4)):G("",!0)])}}},se=q(ee,[["__scopeId","data-v-cb7c141f"]]),oe={class:"home-container"},ae={class:"statistics-section"},ne={class:"main-content"},le={class:"project-list-section"},ce={class:"map-section"},ie={__name:"HomeView",setup($){const r=Q(),_=D(),y=C(null),m=n=>{y.value=n},o=n=>{r.push("/project")};return A(async()=>{await _.fetchProjects()}),(n,l)=>(c(),p("div",oe,[t("div",ae,[s($t)]),t("div",ne,[t("div",le,[s(Xt,{onProjectSelect:m})]),t("div",ce,[s(se,{projects:j(_).projects,"selected-project":y.value,onProjectClick:o},null,8,["projects","selected-project"]),l[0]||(l[0]=t("div",{class:"map-overlay"},null,-1))])])]))}},_e=q(ie,[["__scopeId","data-v-04388899"]]);export{_e as default};
